(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{193:function(e,t,n){"use strict";n.r(t);n(28),n(20),n(26),n(36),n(25),n(37);var r=n(14),o=(n(245),n(22));function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={name:"DebugMode",data:function(){return{isOn:!1,userAgent:"unknown"}},computed:l(l(l({},Object(o.e)({loggedIn:function(e){return e.auth.loggedIn},accessToken:function(e){return e.auth.accessToken},email:function(e){return e.auth.user.email},userName:function(e){return e.auth.user.username},userId:function(e){return e.auth.user.sub},state:function(e){return e}})),Object(o.c)(["profileImageUri","profileName"])),{},{toggleClass:function(){return this.isOn?"bg-green-400":"bg-gray-100"}}),filters:{pretty:function(e){return JSON.stringify(e,null,4)}},methods:{toggle:function(){this.isOn=!this.isOn}}},h=n(13),component=Object(h.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[n("div",{staticClass:"relative inline-block w-10 mr-2 align-middle select-none transition duration-300 ease-in"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.isOn,expression:"isOn"}],staticClass:"absolute block w-6 h-6 rounded-full bg-white border-4  cursor-pointer appearance-none",class:e.toggleClass,attrs:{id:"toggle",type:"checkbox",name:"toggle"},domProps:{checked:Array.isArray(e.isOn)?e._i(e.isOn,null)>-1:e.isOn},on:{change:function(t){var n=e.isOn,r=t.target,o=!!r.checked;if(Array.isArray(n)){var c=e._i(n,null);r.checked?c<0&&(e.isOn=n.concat([null])):c>-1&&(e.isOn=n.slice(0,c).concat(n.slice(c+1)))}else e.isOn=o}}}),e._v(" "),n("label",{staticClass:"block overflow-hidden h-6 rounded-full cursor-pointer",class:e.isOn?"right-0 border-green-400 bg-green-500":"left-0 bg-gray-300 border-gray-200 ",attrs:{for:"toggle"}})]),e._v(" "),n("label",{staticClass:"text-xs",class:e.isOn?"text-green-400":"text-gray-700",attrs:{for:"toggle"}},[e._v("Debug mode "+e._s(e.isOn?"ON":"OFF"))])]),e._v(" "),e.isOn?n("div",[e.$auth.user?n("ul",{staticClass:"mt-6 w-1/2 overflow-ellipsis text-xs text-left"},[n("li",[e._v("This is development mode. In case of error, note following:")]),e._v(" "),n("li",[e._v("Visit from --"+e._s("device:\t "+e.$ua.deviceType()+" os:\t "+e.$ua.os()+", browser:\t "+e.$ua.browser()+", browser version:\t "+e.$ua.browserVersion()))]),e._v(" "),n("li",[e._v(e._s(e.profileName)+", logged in!")]),e._v(" "),n("li",[e._v(" email "+e._s(e.email))]),e._v(" "),n("li",[e._v(" userId "+e._s(e.userName))]),e._v(" "),n("li",[e._v(" userId "+e._s(e.userId))])]):e._e(),e._v(" "),n("h4",[e._v("Dump of state")]),e._v(" "),n("pre",{staticClass:"whitespace-pre text-left text-xs"},[e._v("    "),n("code",[e._v("\n      "+e._s(e._f("pretty")(e.state))+"\n    ")]),e._v("\n  ")]),e._v(" "),n("div")]):e._e()])}),[],!1,null,"5b0527d4",null);t.default=component.exports},198:function(e,t,n){"use strict";n(26),n(517);var r=n(2),o=n(333),c=n(520),l=n(332),f=n(331);r.a.filter("dateSince",(function(e){return Object(o.a)(Object(c.a)(e),{addSuffix:!0})})),r.a.filter("timeSince",(function(e){var time=1e3*Number(e);return Object(o.a)(time,{addSuffix:!0})})),r.a.filter("countDown",(function(e,t){var n=Object(l.a)({start:e,end:1e3*t});return Object(f.a)(n,{delimiter:" : ",zero:!0,format:["months","days","hours","minutes"]})})),r.a.filter("countUp",(function(e,t){var n=Object(l.a)({start:1e3*t,end:e});return Object(f.a)(n,{delimiter:" : ",zero:!0,format:["months","days","hours","minutes"]})}))},202:function(e,t,n){"use strict";n.r(t);var r={name:"BasicPageLayout",components:{HeroPageWave:n(206).default}},o=n(13),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"mt-2 lg:mt-8"},[e._t("top"),e._v(" "),r("hero-page-wave",{attrs:{"is-top":!0,"image-url":n(335)}}),e._v(" "),r("section",{staticClass:"\n    bg-white\n    border-b\n    py-8\n    mt-4"},[r("div",{staticClass:"container w-full mx-auto m-8 text-gray-800"},[e._t("default",[e._v("\n        content "),e._t("default")])],2)]),e._v(" "),r("hero-page-wave",{attrs:{"is-top":!1,"image-url":n(336)}})],2)}),[],!1,null,"a308288e",null);t.default=component.exports},203:function(e,t,n){"use strict";n.r(t);var r={name:"PageSectionTitle"},o=n(13),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",{staticClass:"w-full my-2 text-2xl sm:text-5xl font-bold leading-tight text-center text-gray-800 text-center"},[e._t("default")],2),e._v(" "),e._m(0)])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"w-full mb-4"},[t("div",{staticClass:"h-1 mx-auto gradient w-64 opacity-25 my-0 py-0 rounded-t"})])}],!1,null,"2292416f",null);t.default=component.exports},204:function(e,t,n){"use strict";n.r(t);n(28),n(20),n(26),n(36),n(25),n(37);var r=n(14),o=n(22);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={name:"SigninButton",components:{HeroButton:n(71).default},props:{changeColor:{type:Boolean,default:!1}},computed:l({},Object(o.e)({loggedIn:function(e){return e.auth.loggedIn}})),methods:l({login:function(){this.$auth.loginWith("awsCognito")}},Object(o.b)(["handleUserLogin","handleUserLogout"]))},h=n(13),component=Object(h.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.loggedIn?n("nuxt-link",{attrs:{to:"/challenge"}},[n("hero-button",[e._v("\n      ðŸ¦© Check out the challenges, and join the fun!\n    ")])],1):n("hero-button",{attrs:{"color-change":e.changeColor},on:{click:e.login}},[e._v("\n    ðŸ¦© Sign in !\n  ")])],1)}),[],!1,null,null,null);t.default=component.exports},206:function(e,t,n){"use strict";n.r(t);var r={name:"HeroPageWave",props:{imageUrl:{type:String,default:""},isTop:{type:Boolean,default:!1}}},o=n(13),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"relative",class:e.isTop?"-mt-4 lg:-mt-8 lg:-mb-8":"mb-4 lg:mb-8"},[n("img",{attrs:{src:e.imageUrl}})])}),[],!1,null,null,null);t.default=component.exports},246:function(e,t,n){var content=n(385);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(93).default)("7abdbb3d",content,!0,{sourceMap:!1})},321:function(e,t,n){"use strict";n.r(t);var r={name:"UserAvatar",components:{UserIcon:n(91).r},props:{imageUri:{type:String,default:null},name:{type:String,default:null}}},o=n(13),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex flex-col sm:flex-row justify-center items-center min-h-full transform transition hover:scale-125 hover:-rotate-12 duration-300 ease-in-out"},[e.imageUri?n("img",{staticClass:"block w-16 h-16 object-cover object-top rounded-full ring-4 ring-pink-100 ",attrs:{src:e.imageUri,alt:e.name}}):n("UserIcon",{staticClass:"block text-gray-400 rounded-full ring-4 ring-pink-100 p-2",attrs:{size:"8x"}}),e._v(" "),e.name?n("h6",{staticClass:"uppercase text-xs mt-2 mx-2"},[e._v("\n    "+e._s(e.name)+"\n  ")]):e._e()],1)}),[],!1,null,"418a80cf",null);t.default=component.exports},329:function(e,t,n){"use strict";n(28),n(20),n(26),n(36),n(25),n(37);var r=n(14),o=(n(63),n(22));function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var l={components:{DebugMode:n(193).default},methods:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},Object(o.b)(["handleUserLogin","handleUserLogout"])),fetch:function(){var e=this.$nuxt.context.store;this.$auth.loggedIn&&e.profileLoadStatus<0&&(console.log("[loggedIn-fetch] detected change, we should log the user in: ".concat(this.$auth.loggedIn,", loadstate ").concat(e.profileLoadStatus)),e.dispatch("handleUserLogin"))},created:function(){var e=this;this.$auth.$storage.watchState("loggedIn",(function(t){console.log("[loggedIn-created] change of login status, new value: ".concat(t)),e.$auth.loggedIn?e.handleUserLogin():e.handleUserLogout()}))}},f=(n(384),n(13)),component=Object(f.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"leading-normal tracking-normal gradient font-sans auto-mx min-h-screen "},[n("div",{staticClass:"min-h-screen"},[n("NavBar"),e._v(" "),n("Nuxt")],1),e._v(" "),n("footer",{staticClass:"text-center font-mono uppercase bg-white\n    border-b\n    py-8 text-gray-800 "},[n("div",{staticClass:"mx-auto flex flex-col md:flex-row justify-around"},[n("span",{staticClass:"border-r-2 px-2"},[e._v("Powered by ðŸ”¥ & ðŸ¦„. Â© Mathmagicians, 2021.")]),e._v(" "),n("span",{staticClass:"border-r-2 px-2 text-gray-400"},[e._v(" Commit id: "+e._s(e.$config.git_commit))])]),e._v(" "),n("debug-mode")],1)])}),[],!1,null,null,null);t.a=component.exports;installComponents(component,{NavBar:n(519).default,DebugMode:n(193).default})},330:function(e,t,n){"use strict";n.r(t);var r={name:"MenuItem",props:{link:{type:String,default:"#"}}},o=n(13),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("nuxt-link",{staticClass:"block font-semibold rounded sm:ml-2 px-2",attrs:{to:e.link}},[e._t("default")],2)}),[],!1,null,"55a6c4a0",null);t.default=component.exports},335:function(e,t,n){e.exports=n.p+"3a3e33aa236cacc994d7d24d3252b24e.svg"},336:function(e,t,n){e.exports=n.p+"22b4c401bf4e7cc0928cb110f8260216.svg"},340:function(e,t,n){n(341),e.exports=n(342)},384:function(e,t,n){"use strict";n(246)},385:function(e,t,n){var r=n(92)((function(i){return i[1]}));r.push([e.i,".gradient{background:linear-gradient(90deg,#fa709a 0,#fee140)}",""]),e.exports=r},386:function(e,t,n){e.exports=n.p+"img/flamingo.669807f.jpeg"},387:function(e,t,n){"use strict";n.r(t),n.d(t,"state",(function(){return l})),n.d(t,"getters",(function(){return f})),n.d(t,"mutations",(function(){return h})),n.d(t,"actions",(function(){return d}));n(28),n(20),n(26),n(36),n(37);var r=n(7),o=n(14);n(43),n(30),n(63),n(25),n(388),n(245);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var l=function(){return{stravaDataAccessAuthLoadStatus:-1,profileLoadStatus:-1,strava_token:null,profile:{id:null,basic:{name:null,mail:null,gender:null,fav:null,healthy:!0},stars:null,badges:null,runs:null,runningAppAuthentication:{strava:null},challenges:[{id:"ch1"},{id:"ch-2"}],events:null}}},f={profileImageUri:function(e){return e.auth.loggedIn&&e.auth.user&&e.auth.user.picture?JSON.parse(e.auth.user.picture).data.url:null},profileName:function(e){var t;return null===(t=e.profile.basic)||void 0===t?void 0:t.name},isBasicProfileReady:function(e){return!!(e.profile.basic&&e.profile.basic.gender&&e.profile.basic.fav&&e.profile.basic.mail&&e.profile.basic.name)},isChallengeReady:function(e){var t;return null===(t=e.profile.my_challenges)||void 0===t?void 0:t.length},canUseStrava:function(e,t){return t.hasRequestedScopes&&t.hasStravaAuthorizationCode&&t.hasStravaRefreshToken&&t.hasStravaAccessToken&&t.isStravaAccessTokenValid},hasStravaAuthorizationCode:function(e){return!!e.profile.runningAppAuthentication.strava&&!!e.profile.runningAppAuthentication.strava.authorization_code},hasRequestedScopes:function(e){return e.profile.runningAppAuthentication.strava&&"read,activity:read_all"===e.profile.runningAppAuthentication.strava.scopes},hasStravaRefreshToken:function(e){return!!e.profile.runningAppAuthentication.strava&&!!e.profile.runningAppAuthentication.strava.refresh_token},hasStravaAccessToken:function(e){return!!e.profile.runningAppAuthentication.strava&&!!e.profile.runningAppAuthentication.strava.access_token},isStravaAccessTokenValid:function(e,t){return t.hasStravaAccessToken&&!!e.profile.runningAppAuthentication.strava.expires_at&&e.profile.runningAppAuthentication.strava.expires_at>Date.now()/1e3},authorization_code:function(e){return!!e.profile.runningAppAuthentication.strava&&e.profile.runningAppAuthentication.strava.authorization_code},authorization_time:function(e){return!!e.profile.runningAppAuthentication.strava&&e.profile.runningAppAuthentication.strava.authorization_time},scopes:function(e){return!!e.profile.runningAppAuthentication.strava&&e.profile.runningAppAuthentication.strava.scopes},refresh_token:function(e){return!!e.profile.runningAppAuthentication.strava&&e.profile.runningAppAuthentication.strava.refresh_token},access_token:function(e){return!!e.profile.runningAppAuthentication.strava&&e.profile.runningAppAuthentication.strava.access_token},expires_at:function(e){return!!e.profile.runningAppAuthentication.strava&&new Date(1e3*e.profile.runningAppAuthentication.strava.expires_at).toISOString()},latest_fetch:function(e){return!!e.profile.runningAppAuthentication.strava&&e.profile.runningAppAuthentication.strava.latest_server_fetch},runs:function(e){return e.profile.runs}},h={setProfileLoadStatus:function(e,t){e.profileLoadStatus=t},setProfileId:function(e,t){e.profile.id=t},setProfile:function(e,t){e.profile=function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},t)},setProfileName:function(e,t){e.profile.basic.name=t},setProfileMail:function(e,t){e.profile.basic.mail=t},setProfileGender:function(e,t){"M"===t||"F"===t?e.profile.basic.gender=t:console.warn("[setProfileGender] gender needs to be M or F, not ".concat(t))},setProfileFav:function(e,t){e.profile.basic.fav=t},setProfileHealthy:function(e,b){e.profile.basic.healthy=b},setStravaDataAccessAuthLoadStatus:function(e,t){e.stravaDataAccessAuthLoadStatus=t},setStravaAuthorization:function(e,t){var n=t.authorization_code,r=t.scopes;console.log("[setStravaAuthorization] received code ".concat(n,", \t scopes ").concat(r)),e.profile.runningAppAuthentication.strava={authorization_time:new Date,authorization_code:n,scopes:r},console.log("[setStravaAuthorization] update done, strava is \t",JSON.stringify(e.profile.runningAppAuthentication.strava))},setStravaToken:function(e,t){e.strava_token=t,e.profile.runningAppAuthentication.strava.id=String(t.athlete.id),e.profile.runningAppAuthentication.strava.access_token=t.access_token,e.profile.runningAppAuthentication.strava.refresh_token=t.refresh_token,e.profile.runningAppAuthentication.strava.expires_at=t.expires_at},setStravaAccess:function(e,t){console.log("[setStravaAccess] received new access token for strava ",t),e.profile.runningAppAuthentication.strava.access_token=t.access_token,e.profile.runningAppAuthentication.strava.expires_at=t.expires_at},nukeStrava:function(e){e.profile.runningAppAuthentication.strava=null,e.strava_token=null},nukeProfile:function(e){var t=function(e){Object.getOwnPropertyNames(e).forEach((function(p){e[p]=null}))},b=t(e.profile.basic),n=t(e.profile.runningAppAuthentication);t(e.profile),e.profile.basic=b,e.profile.runningAppAuthentication=n,console.log("[nukeProfile] profile = ",e.profile)}},d={acquireStravaRefreshToken:function(e){return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.commit,r=e.state,o=e.getters,c=e.dispatch,o.hasStravaRefreshToken){t.next=16;break}return n("setStravaDataAccessAuthLoadStatus",3),t.next=5,c("getStravaToken");case 5:return l=t.sent,n("setStravaDataAccessAuthLoadStatus",4),!r.profile.basic.gender&&l.athlete.sex&&n("setProfileGender",l.athlete.sex),t.next=10,c("postProfile");case 10:return n("setStravaDataAccessAuthLoadStatus",5),t.next=13,c("fetchProfile");case 13:n("setStravaDataAccessAuthLoadStatus",0),t.next=17;break;case 16:console.info("[acquireStravaRefreshToken] Dont need to acquire anything, token is ",r.profile.runningAppAuthentication.strava.token);case 17:case"end":return t.stop()}}),t)})))()},getStravaToken:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.commit,o=e.state,e.getters,n.next=3,t.$axios({method:"post",url:t.$config.strava_token_url,baseURL:t.$config.strava_base_url,data:{client_id:t.$config.strava_client_id,client_secret:t.$config.strava_client_secret,code:o.profile.runningAppAuthentication.strava.authorization_code,grant_type:"authorization_code"}});case 3:return c=n.sent,r("setStravaToken",c.data),n.abrupt("return",c.data);case 6:case"end":return n.stop()}}),n)})))()},postProfile:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.state,(0,e.dispatch)("grabProfileIdFromAuth"),n.next=4,t.$axios({method:"post",url:"/profile/".concat(r.profile.id),data:r.profile});case 4:n.sent;case 5:case"end":return n.stop()}}),n)})))()},fetchProfile:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.state,o=e.commit,console.info("[fetchProfile] fetching profile for user ".concat(r.profile.id)),n.prev=2,n.next=5,t.$axios({method:"get",url:"/profile/".concat(r.profile.id)});case 5:return c=n.sent,o("setProfile",c.data),console.info("[fetchProfile] fetched profile for user ".concat(r.profile.id),c.data,r.profile),n.abrupt("return",c.status);case 11:if(n.prev=11,n.t0=n.catch(2),!n.t0.response||404!==n.t0.response.status){n.next=18;break}return console.info("[fetchProfile] ".concat(r.profile.id,": does not exist in db")),n.abrupt("return",n.t0.response.status);case 18:if(!n.t0.response){n.next=23;break}throw console.error("[fetchProfile] ".concat(r.profile.id,": Uh, oh, somethings wrong with the response")),n.t0;case 23:throw console.error("[fetchProfile] ".concat(r.profile.id,": Cant communicate with backend")),n.t0;case 25:case"end":return n.stop()}}),n,null,[[2,11]])})))()},putNewProfile:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.state,o=e.commit,n.prev=1,n.next=4,t.$axios({method:"put",url:"/profile/".concat(r.profile.id),data:r.profile});case 4:c=n.sent,o("setProfile",c.data),n.next=12;break;case 8:throw n.prev=8,n.t0=n.catch(1),console.error("[putNewProfile] ".concat(r.profile.id)),n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,8]])})))()},loadProfile:function(e){return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.commit,r=e.dispatch,o=e.state,n("setProfileLoadStatus",1),r("grabProfileIdFromAuth"),t.next=5,r("fetchProfile");case 5:n("setProfileLoadStatus",0),console.info("[loadProfile] Loading profile for user ".concat(o.profile.id));case 7:case"end":return t.stop()}}),t)})))()},grabProfileIdFromAuth:function(e){var t=e.commit,n=e.state;n.profile.id||(t("setProfileId","U-".concat(n.auth.user.sub)),console.log("[grabProfileIdFromAuth] setting profile id, as it was empty ",n.profile.id))},handleUserLogin:function(e){return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.commit,r=e.state,o=e.dispatch,r.auth.loggedIn){t.next=3;break}throw new Error("[handleUserLogin] User not authenticated, cant log in.");case 3:return 0===r.profileLoadStatus&&r.profile.id&&(console.info("[handleUserLogin] User already logged in, cant do it twice ðŸ˜‰. Will just fetch data instead."),o("loadProfile")),n("setProfileLoadStatus",1),o("grabProfileIdFromAuth"),t.next=8,o("fetchProfile");case 8:if(200!==(c=t.sent)){t.next=13;break}n("setProfileLoadStatus",0),t.next=23;break;case 13:if(404!==c){t.next=21;break}n("setProfileLoadStatus",12),o("fillDefaultValuesForProfile"),o("putNewProfile"),n("setProfileLoadStatus",15),o("loadProfile"),t.next=23;break;case 21:throw n("setProfileLoadStatus",10),new Error("[handleUserLogin] Received stats code "+c);case 23:case"end":return t.stop()}}),t)})))()},fillDefaultValuesForProfile:function(e){var t=e.commit,n=e.state,r=e.dispatch;console.info("[fillDefaultValuesForProfile] kind of empty here, grabbing default values"),r("grabProfileIdFromAuth"),t("setProfileName",n.auth.user?n.auth.user.preferred_username||n.auth.user.given_name||n.auth.user.username||n.auth.user.sub:"guest"),t("setProfileMail",n.auth.user.email),t("setProfileGender",n.auth.user.gender),t("setProfileHealthy",!0),console.info("[fillDefaultValuesForProfile] kind of empty here, grabbing default values",n.profile)},handleUserLogout:function(e){var t=e.commit;e.state;t("nukeStrava"),t("nukeProfile"),t("setStravaDataAccessAuthLoadStatus",0),t("setProfileLoadStatus",-1)},updateGender:function(e,g){var t=e.commit,n=e.dispatch;t("setProfileGender",g),t("setProfileLoadStatus",5),n("postProfile"),n("loadProfile")},updateFav:function(e,t){var n=e.commit,r=e.dispatch;n("setProfileFav",t),n("setProfileLoadStatus",5),r("postProfile"),r("loadProfile")},updateHealthy:function(e,b){var t=e.commit,n=e.dispatch;t("setProfileHealthy",b),t("setProfileLoadStatus",5),n("postProfile"),n("loadProfile")},updateMail:function(e,t){var n=e.commit,r=e.dispatch;n("setProfileMail",t),n("setProfileLoadStatus",5),r("postProfile"),r("loadProfile")},updateName:function(e,t){var n=e.commit,r=e.dispatch;n("setProfileName",t),n("setProfileLoadStatus",5),r("postProfile"),r("loadProfile")},revokeStravaAccess:function(e){var t=e.commit,n=e.dispatch;console.info("[revokeStravaAccess] Clearing codes"),t("nukeStrava",null),t("setStravaDataAccessAuthLoadStatus",6),n("postProfile"),t("setStravaDataAccessAuthLoadStatus",7),n("loadProfile"),t("setStravaDataAccessAuthLoadStatus",0),console.info("[revokeStravaAccess] Profile updated, codes cleared")}}},389:function(e,t,n){"use strict";n.r(t),n.d(t,"state",(function(){return f})),n.d(t,"getters",(function(){return h})),n.d(t,"mutations",(function(){return d})),n.d(t,"actions",(function(){return v}));n(28),n(20),n(26),n(36),n(25),n(37);var r=n(7),o=n(14),c=n(87);n(43),n(338),n(63);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var f=function(){return{myChallenge:{Athletes:[]},myAthlete:{}}},h={getAthletes:function(e){return e.myChallenge.Athletes},getMyChallenge:function(e){return e.myChallenge},getStars:function(e){var t;return null===(t=e.myChallenge)||void 0===t?void 0:t.Stars},getMyAthlete:function(e){return e.myAthlete},getAthletePosition:function(e){return function(t){return e.myChallenge.Athletes.findIndex((function(e){return e.ProfileId===t}))+1}}},d={setMyChallenge:function(e,t){e.myChallenge=t},setChallenges:function(e,t){e.challenges=Object(c.a)(t)},setMyAthlete:function(e,t){e.myAthlete=function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},t)}},v={fetchMyAthlete:function(e,t){return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,c,l,f,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.commit,e.state,e.getters,o=e.dispatch,c=t.athlete,l=t.challenges,console.log("[fetchMyAthlete] fetching athlete data for logged in profile, athlete",c,l),!(!(null!=l&&l.length)>0)){n.next=6;break}return console.warn("[fetchAthlete] Received invalid parameters athlete:".concat(c,", challenge: ").concat(l)),n.abrupt("return");case 6:return f=l[0],n.next=9,o("fetchAthlete",{athlete:c,challenge:f});case 9:(h=n.sent)&&r("setMyAthlete",h);case 11:case"end":return n.stop()}}),n)})))()},fetchAthlete:function(e,t){var n=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var o,c,l,f;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=e.commit,e.state,e.dispatch,c=t.athlete,l=t.challenge,console.log("[fetchAthlete] fetching athlete data for athlete ".concat(c," in challenge ").concat(l)),null!=c&&c.length&&null!=l&&l.length){r.next=6;break}return console.warn("[fetchAthlete] Received invalid parameters athlete:".concat(c,", challenge: ").concat(l)),r.abrupt("return");case 6:return r.prev=6,r.next=9,n.$axios({method:"get",url:"/athlete/".concat(c,"?challenge=").concat(l)});case 9:return f=r.sent,o("setMyAthlete",f.data),console.log("[FetchMyAthlete] Challenge data fetched for athlete ",c),r.abrupt("return",f.data);case 15:r.prev=15,r.t0=r.catch(6);case 17:case"end":return r.stop()}}),r,null,[[6,15]])})))()},fetchMyChallenge:function(e,t){var n=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var o,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=e.commit,e.state,e.dispatch,console.log("[FetchMyChallenge] ready to fetch challenge:",t),null!=t&&t.length){r.next=5;break}return console.warn("Not participating in any challenge"),r.abrupt("return");case 5:return r.prev=5,r.next=8,n.$axios({method:"get",url:"/challenge/".concat(t[0])});case 8:c=r.sent,console.log("[FetchMyChallenge] received data from server"),o("setMyChallenge",c.data),console.log("[FetchMyChallenge] Challenge data fetched for athlete"),r.next=27;break;case 14:if(r.prev=14,r.t0=r.catch(5),!r.t0.response||404!==r.t0.response.status){r.next=20;break}console.info("[fetchChallenge] does not exist in db"),r.next=27;break;case 20:if(!r.t0.response){r.next=25;break}throw console.error("[fetchChallenge]: Uh, oh, somethings wrong with the response"),r.t0;case 25:throw console.error("[fetchChallenge] : Cant communicate with backend"),r.t0;case 27:case"end":return r.stop()}}),r,null,[[5,14]])})))()},fetchStars:function(e){return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.getters,r=e.dispatch,n.getStars){t.next=4;break}return t.next=4,r("fetchMyChallenge");case 4:case"end":return t.stop()}}),t)})))()},fetchChallenges:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.commit,e.state,n.prev=1,n.next=4,t.$axios({method:"get",url:"/challenge"});case 4:o=n.sent,r("setChallenges",o.data),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),console.error("[fetchChallenge]: Uh, oh, somethings wrong with the response");case 11:case"end":return n.stop()}}),n,null,[[1,8]])})))()},updateChallenge:function(e,t){return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.state,e.commit,t.next=3,console.info("[updateChallenge] updating challenges");case 3:console.warn("not implemented!");case 4:case"end":return t.stop()}}),t)})))()}}},394:function(e,t){},396:function(e,t){},406:function(e,t){},408:function(e,t){},433:function(e,t){},435:function(e,t){},436:function(e,t){},441:function(e,t){},443:function(e,t){},449:function(e,t){},451:function(e,t){},470:function(e,t){},482:function(e,t){},485:function(e,t){},519:function(e,t,n){"use strict";n.r(t);n(28),n(20),n(26),n(36),n(25),n(37);var r=n(14),o=n(91),c=n(22),l=n(330),f=n(204),h=n(321);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={name:"NavBar",components:{HeroButton:n(71).default,UserAvatar:h.default,SigninButton:f.default,XIcon:o.s,MenuIcon:o.o,NavBarItem:l.default},data:function(){return{isOpen:!1,isUserOpen:!1,scrollPosition:null,menuItems:[{link:"/challenge",text:"Challenge"},{link:"/me",text:"My Runs"},{link:"/engineering",text:"Engineering"},{link:"/about",text:"Rules"}],dropDownLoggedInItems:[{link:"/profile?action=read",text:("F"===this.gender?"ðŸƒâ€â™€ï¸\t":"")+("M"===this.gender?"ðŸƒâ€â™‚ï¸\t":"")+"View Profile"},{link:"/profile?action=update",text:"Profile Settings"},{link:"/login",text:"Sign out",action:"signOut"}],notLoggedInITems:[{link:"/profile?action=login",text:"Signup"}]}},computed:v(v({changeColor:function(){return this.scrollPosition>10},changeColorTextClass:function(){return this.changeColor?"text-pink-400 hover:border-pink-400 focus:border-pink-400":"text-white hover:border-white focus:border-white"}},Object(c.e)({loggedIn:function(e){return e.auth.loggedIn}})),Object(c.c)(["profileImageUri","profileName"])),mounted:function(){window.addEventListener("scroll",this.updateScroll)},methods:{updateScroll:function(){this.scrollPosition=window.scrollY},signOut:function(){this.$auth.logout()},handleFunctionCall:function(e){this[e]()}}},x=n(13),component=Object(x.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("header",{staticClass:"sticky w-full top-0 flex flex-col sm:flex-row items-center justify-between lg:mb-2",class:e.changeColor?"bg-white text-pink-400":"bg-transparent text-white",staticStyle:{"z-index":"9999"}},[r("div",{staticClass:"w-full mx-auto flex flex-col lg:flex-row flex-wrap items-center justify-between mt-0 py-2"},[r("nav-bar-item",{attrs:{link:"/"}},[r("div",{staticClass:"pl-4 pb-4 flex flex-col-reverse lg:flex-row items-center font-bold text-lg lg:text-xl xl:text-2xl\n      transform transition hover:text-underline hover:scale-110 hover:-translate-y-1 duration-300 ease-in-out"},[r("img",{staticClass:"w-16 h-16 object-cover object-left-top rounded-full ring-2 ",class:e.changeColor?"ring-pink-400":"ring-pink-50",attrs:{src:n(386),alt:"Crush your so-called peer-birds, and be the fastest flamingo in the flock"}}),e._v(" "),r("span",{staticClass:"px-2 flex-shrink",class:e.changeColor?"text-pink-600":"text-white"},[e._v("Supercalifragilisticexpialdociously ... RUN!")])])]),e._v(" "),r("div",{staticClass:"sm:hidden"},[r("button",{staticClass:"block font-bold text-2xl focus:outline-none py-2",attrs:{type:"button"},on:{click:function(t){e.isOpen=!e.isOpen}}},[e.isOpen?r("XIcon",{staticClass:"text-current",class:e.changeColorTextClass,attrs:{size:"1.5x"}}):e._e(),e._v(" "),e.isOpen?e._e():r("MenuIcon",{staticClass:"text-current",class:e.changeColorTextClass,attrs:{size:"1.5x"}})],1)])],1),e._v(" "),r("nav",{staticClass:"w-full flex-grow sm:flex lg:items-center lg:w-auto mt-2 lg:mt-0 p-4 lg:p-0 z-20",class:e.isOpen?"block":"hidden"},[r("ul",{staticClass:"list-reset flex flex-col sm:flex-row items-start justify-end flex-1 sm:items-center"},e._l(e.menuItems,(function(t){return r("li",{key:t.link},[r("nav-bar-item",{staticClass:"hover:border-b-8 transform transition hover:scale-105 hover:-rotate-6 duration-300 ease-in-out",class:e.changeColor?"text-pink-400 hover:border-pink-400":"text-white hover:border-white",attrs:{link:t.link}},[r("span",{staticClass:"whitespace-nowrap"},[e._v(e._s(t.text))])])],1)})),0),e._v(" "),r("div",{staticClass:"hidden sm:block sm:relative"},[e.loggedIn?r("div",{staticClass:"mx-2"},[r("button",{staticClass:"block rounded-full relative p-1 focus:outline-none hover:outline-none",on:{click:function(t){e.isUserOpen=!e.isUserOpen}}},[r("user-avatar",{staticClass:"w-full w-32",class:e.changeColorTextClass,attrs:{"image-uri":e.profileImageUri,name:e.profileName}})],1)]):r("signin-button",{staticClass:"flex-nowrap",attrs:{"change-color":e.changeColor}}),e._v(" "),e.isUserOpen?r("button",{staticClass:"fixed top-0 right-0 bottom-0 left-0 h-full w-full bg-grey-900 opacity-10 cursor-default",attrs:{tabindex:"-1"},on:{click:function(t){e.isUserOpen=!1}}}):e._e(),e._v(" "),e.isUserOpen?r("div",{staticClass:"absolute right-0 bg-white rounded-lg shadow-lg focus w-48 text-pink-400"},e._l(e.dropDownLoggedInItems,(function(t){return r("nav-bar-item",{key:t.link,class:t.action?"":"px-4 py-2 hover:border-pink-400 hover:border-b-8 transform transition hover:scale-105 hover:-rotate-6 duration-300 ease-in-out",attrs:{link:t.link}},[t.action?r("hero-button",{on:{click:function(n){return e.handleFunctionCall(t.action)}}},[e._v("\n            "+e._s(t.text)+"\n          ")]):r("span",[e._v("\n            "+e._s(t.text)+"\n          ")])],1)})),1):e._e()],1),e._v(" "),e.loggedIn?r("div",{staticClass:"sm:hidden"},[r("button",{staticClass:"mt-2 focus:outline-none"},[r("user-avatar",{staticClass:"w-32",attrs:{"image-uri":e.profileImageUri,name:e.profileName}})],1),e._v(" "),r("ul",{staticClass:"flex flex-col items-start justify-end flex-1 list-reset"},[r("li",e._l(e.dropDownLoggedInItems,(function(t){return r("nav-bar-item",{key:t.link,staticClass:"hover:border-b-8 transform transition hover:scale-105 hover:-rotate-6 duration-300 ease-in-out",class:e.changeColor?"text-pink-400 hover:border-pink-400":"text-white hover:border-white",attrs:{link:t.link}},[t.action?r("hero-button",{attrs:{"color-change":!0},on:{click:function(n){return e.handleFunctionCall(t.action)}}},[e._v("\n              "+e._s(t.text)+"\n            ")]):r("span",[e._v("\n              "+e._s(t.text)+"\n            ")])],1)})),1)])]):e._e()]),e._v(" "),r("hr",{staticClass:"border-b border-gray-100 opacity-25 my-0 py-0"})])}),[],!1,null,null,null);t.default=component.exports},61:function(e,t,n){"use strict";var r=n(202),o=n(203),c={components:{HeroButton:n(71).default,PageSectionTitle:o.default,BasicPageLayout:r.default},filters:{pretty:function(e){return JSON.stringify(e,null,4)}},layout:"empty",props:{error:{type:Object,default:null}},data:function(){return{pageNotFound:"404 Not Found",otherError:"An error occurred"}},head:function(){return{title:this.error&&404===this.error.statusCode?this.pageNotFound:this.otherError}},mounted:function(){console.error("Error is",this.error)}},l=n(13),component=Object(l.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("basic-page-layout",[n("page-section-title",[e._v("\n    "+e._s(e.otherError)+"\n  ")]),e._v(" "),n("pre",{staticClass:"whitespace-pre text-left text-xs"},[e._v("    "),n("code",[e._v("\n      "+e._s(e._f("pretty")(e.error))+"\n    ")]),e._v("\n  ")]),e._v(" "),n("nuxt-link",{attrs:{to:"/"}},[n("hero-button",[e._v("\n      Go back home, ðŸ¦©\n    ")])],1)],1)}),[],!1,null,null,null);t.a=component.exports},71:function(e,t,n){"use strict";n.r(t);var r={name:"HeroButton",props:{colorChange:{type:Boolean,default:!1}}},o=n(13),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("button",{staticClass:"mx-auto lg:mx-0 hover:underline  font-bold rounded-full my-6 py-4 px-8 shadow-lg\n  focus:outline-none focus:shadow-outline\n  transform transition hover:scale-105 duration-300 ease-in-out",class:e.colorChange?"gradient text-white":"bg-white text-gray-800",on:{click:function(t){return e.$emit("click")}}},[e._t("default")],2)}),[],!1,null,null,null);t.default=component.exports}},[[340,25,5,26]]]);